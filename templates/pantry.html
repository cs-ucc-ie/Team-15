<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <title>Pantry</title>
</head>
<body>

    <!-- Nav Bar -->
    {% include 'navbar.html' %} 
    <h1>Pantry</h1>

    <!-- Ingredients List -->
    <h2>Available Ingredients</h2>
    <ul id="ingredient-list">
        {% for ingredient in ingredients %}
        <li onclick="toggleIngredient({{ ingredient.id }}, '{{ ingredient.name }}')">
            {{ ingredient.name }}
        </li>
        {% endfor %}
    </ul>

    <!-- Selected Ingredients -->
    <h2>Selected Ingredients</h2>
    <ul id="selected-ingredients-list"></ul>

    <!-- Matching Cocktails -->
    <h2>Matching Cocktails</h2>
    <ul id="cocktail-list"></ul>

    <script>
        let selectedIngredients = [];

        function toggleIngredient(id, name) {
            const index = selectedIngredients.findIndex(ing => ing.id === id);
            if (index > -1) {
                selectedIngredients.splice(index, 1);
            } else {
                selectedIngredients.push({ id, name });
            }
            updateUI();
        }

        function updateUI() {
            document.getElementById("selected-ingredients-list").innerHTML = 
                selectedIngredients.map(ing => `<li onclick="toggleIngredient(${ing.id}, '${ing.name}')">${ing.name}</li>`).join("");

            fetch('/get_cocktails', {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ ingredients: selectedIngredients.map(ing => ing.id) })
            })
            .then(response => response.json())
            .then(cocktails => {
                document.getElementById("cocktail-list").innerHTML = 
                    cocktails.length ? cocktails.map(c => `<li>${c.name}</li>`).join("") : "<li>No matches found</li>";
            });
        }
    </script>

</body>
</html>
