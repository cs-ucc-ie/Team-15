<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <title>Pantry</title>
</head>

<body>
    <!-- Nav Bar -->
    {% include 'navbar.html' %} 

    <div class="pantry-container">
    <!-- Ingredients List -->
     <div class="pantry-l1">
    <h2>Available Ingredients</h2>
    <ul id="ingredient-list">
        {% for ingredient in ingredients %}
        <li onclick="toggleIngredient({{ ingredient.id }}, '{{ ingredient.name }}')">
            {{ ingredient.name }}
        </li>
        {% endfor %}
    </ul>
    </div>
    <!-- Selected Ingredients -->
    <div class="pantry-r1">
    <h2>Selected Ingredients</h2>
    <ul id="selected-ingredients-list"></ul>
    <p>Tap to remove ingredient</p>
    </div>

    <!-- Matching Cocktails -->
    <div class="pantry-r2">
    <h2>Matching Cocktails</h2>
    <ul id="cocktail-list"></ul>
    </div>
    <script>
        let selectedIngredients = [];

        function toggleIngredient(id, name) {
            const index = selectedIngredients.findIndex(ing => ing.id === id);
            if (index > -1) {
                selectedIngredients.splice(index, 1);
            } else {
                selectedIngredients.push({ id, name });
            }
            updateUI();
        }

        function updateUI() {
            document.getElementById("selected-ingredients-list").innerHTML = 
                selectedIngredients.map(ing => `<li onclick="toggleIngredient(${ing.id}, '${ing.name}')">${ing.name}</li>`).join("");

            fetch('/get_cocktails', {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ ingredients: selectedIngredients.map(ing => ing.id) })
            })
            .then(response => response.json())
            .then(cocktails => {
                document.getElementById("cocktail-list").innerHTML = 
                    cocktails.length ? cocktails.map(c => `<li>
                        <img src= "{{ url_for('static', filename='cosmopolitan.jpg')}}"alt="Placeholder image for layout">
                        <div class="matching-cocktail-info">
                        ${c.name}
                        <p><a href="{{ url_for('homepage') }}">See Recipe</a> </p></div>
                        </li>`).join("") : "<li>No matches found</li>";

            });
        }
    </script>
    </div>
</body>
</html>
